{% extends "base.html" %}
{% load static %}
{% block head_title %}
  Login
{% endblock head_title %}
{% block head %}
  <style>
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeIn {
  animation: fadeIn 0.4s ease-out;
}

.animate-slideUp {
  animation: slideUp 0.3s ease-out;
}
  </style>
{% endblock head %}
{% block content %}
  <div class="justify-center px-4 pb-8 md:pt-4 flex items-center">
    <div class="max-w-5xl mx-auto flex items-stretch h-auto">
      <div class="bg-neutral-900/70 backdrop-blur-md shadow-inset-white rounded-2xl overflow-hidden flex-1 flex flex-col md:flex-row">
        <div class="flex flex-col md:flex-row w-full">
          <!-- Welcome Card -->
          <div class="md:w-[400px] relative overflow-hidden h-full bg-black/30 animate-fadeIn hidden md:block">
            <svg width="100%"
                 height="100%"
                 viewBox="0 0 800 800"
                 class="absolute top-0 left-0 z-0">
              <defs>
              <filter id="bb-filter" x="-100%" y="-100%" width="400%" height="400%">
              <feGaussianBlur stdDeviation="105" in="SourceGraphic" result="blur"></feGaussianBlur>
              </filter>
              </defs>
              <g filter="url(#bb-filter)">
              <ellipse rx="277.5" ry="70.5" cx="374" cy="152" fill="#08b74f"></ellipse>
              <ellipse rx="500" ry="70.5" cx="0" cy="800" fill="#2e90fa"></ellipse>
              </g>
            </svg>
            <div class="relative z-10 h-full flex flex-col justify-between">
              <div class="flex justify-between items-start p-12">
                <img src="{% static 'foss-bu-dark.png' %}"
                     alt="FOSS BU"
                     class="h-8 md:h-12 w-auto"
                     width="48"
                     height="48">
                <img src="{% static 'logo.svg' %}"
                     alt="Re-Dcrypt"
                     class="h-8 md:h-12 w-auto"
                     width="48"
                     height="48">
              </div>
              <div class="p-8">
                <h2 class="text-6xl font-black leading-tight text-white text-start">
                  <span class="text-white/80" id="welcomeText">Let's Log You In</span>
                </h2>
              </div>
            </div>
          </div>
          <!-- Mobile Welcome Card -->
          <div class="md:hidden relative overflow-hidden h-full bg-black/30 animate-fadeIn">
            <svg width="100%"
                 height="100%"
                 viewBox="0 0 800 800"
                 class="absolute top-0 left-0 z-0">
              <defs>
              <filter id="bb-filter-mobile" x="-100%" y="-100%" width="400%" height="400%">
              <feGaussianBlur stdDeviation="105" in="SourceGraphic" result="blur"></feGaussianBlur>
              </filter>
              </defs>
              <g filter="url(#bb-filter-mobile)">
              <ellipse rx="277.5" ry="70.5" cx="374" cy="152" fill="#08b74f"></ellipse>
              <ellipse rx="277.5" ry="70.5" cx="609" cy="577" fill="#2e90fa"></ellipse>
              </g>
            </svg>
            <div class="relative z-10 h-full flex flex-col justify-between">
              <div class="flex justify-between items-start px-12 pt-12 pb-6">
                <img src="{% static 'foss-bu-dark.png' %}"
                     alt="FOSS BU"
                     class="h-8 md:h-12 w-auto"
                     width="48"
                     height="48">
                <img src="{% static 'logo.svg' %}"
                     alt="Re-Dcrypt"
                     class="h-8 md:h-12 w-auto"
                     width="48"
                     height="48">
              </div>                  

              <div class="p-6">
                <h2 class="text-4xl md:text-6xl font-black leading-tight text-white text-center md:text-left">
                  <span class="text-white/80" id="welcomeText">Let's Log You In</span>
                </h2>
              </div>
            </div>
          </div>
          <!-- Form Section -->
          <div class="md:w-[500px] flex-1">
            <div class="flex flex-col min-h-full">
              <form method="post"
                    action="{% url 'account_login' %}"
                    class="h-full"
                    id="login_form">
                {% csrf_token %}
                <div class="flex-1 animate-slideUp p-6">
                  <div class="flex flex-col items-center mb-8">
                    <span class="flex items-center justify-center w-12 h-12 rounded-full bg-green-600/20 text-green-500 mb-4">
                      <i class="ph-fill ph-user"></i>                    </span>
                    <div class="text-center">
                      <h2 class="text-xl font-bold text-green-500">Welcome back!</h2>
                      <p class="text-neutral-400 text-sm mt-2">
                        Don't have an account?
                        <a href="{% url 'account_signup' %}"
                           class="text-green-500 hover:underline">Sign up</a>
                      </p>
                    </div>
                  </div>
                  <div class="space-y-6">
                    <div class="flex flex-col gap-y-2">
                      <label for="id_login"
                             class=" text-sm font-medium text-gray-400 text-start mx-1">Email or Username</label>
                      <div class="relative">
                        <input type="text"
                               name="login"
                               required
                               placeholder="Username"
                               class="w-full bg-neutral-900/70 shadow-inset-white backdrop-blur-sm text-gray-100 rounded-xl py-3 px-4 transition-all duration-300 hover:ring hover:ring-green-500 focus:ring focus:ring-green-500 focus:outline-none">
                      </div>
                    </div>
                    <div class="flex flex-col gap-y-2 relative">
                      <div class="flex items-center justify-between mx-1">
                        <label for="id_password" class="text-sm font-medium text-gray-400">Password</label>
                        <a href="{% url 'account_reset_password' %}"
                           class="text-green-500 hover:underline text-sm">Forgot Password?</a>
                      </div>
                      <div>
                        <input type="password"
                               name="password"
                               required
                               placeholder="Password"
                               id="id_password"
                               class="w-full bg-neutral-900/70 shadow-inset-white backdrop-blur-sm text-gray-100 rounded-xl py-3 px-4 transition-all duration-300 hover:ring hover:ring-green-500 focus:ring focus:ring-green-500 focus:outline-none">
                        <span class="ph-fill ph-eye cursor-pointer text-xl text-neutral-400 absolute right-3 top-1/2"
                              id="togglePassword"></span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="px-6">
                  <button type="submit"
                          class="w-full bg-neutral-900/70 shadow-inset-white backdrop-blur-sm rounded-xl transition-all duration-200 text-sm py-3 px-6 hover:bg-green-500 hover:-translate-y-0.5 text-neutral-100 hover:text-neutral-50 font-bold flex items-center justify-center gap-2">
                    <i class="ph-bold ph-sign-in"></i>                    <span class="button-text">Login</span>
                  </button>
                  <div class="my-4 flex items-center">
                    <div class="flex-grow border-t border-neutral-700"></div>
                    <span class="mx-4 flex-shrink text-neutral-400 text-sm">OR</span>
                    <div class="flex-grow border-t border-neutral-700"></div>
                  </div>
                  <div>{% include "components/google_onetap.html" %}</div>
                  <p class="text-neutral-400 text-xs py-6 text-center">
                    By logging in, you agree to Re-Dcrypt's
                    <a href="{% url 'terms_and_conditions' %}"
                       class="text-green-500 hover:underline">Terms of Service</a> and
                    <a href="{% url 'privacy_policy' %}"
                       class="text-green-500 hover:underline">Privacy Policy</a>
                  </p>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
const welcomeMessages = [
  "Ready to crack some codes?",
  "Back for more puzzles?",
  "The rabbit hole awaits...",
  "Time to decrypt the truth",
  "Your next challenge awaits",
  "Looks like someone's stuck",
  "Need those hints, eh?",
  "The matrix has you...",
  "Plot twist: This is level 0",
  "Forgot the password again?",
  "Hopefully you're not a bot",
  "Welcome back, detective",
  "Puzzle master returns!",
  "The game is afoot",
  "*cryptic noises intensify*",
];

document.addEventListener("DOMContentLoaded", function () {
  const welcomeElements = document.querySelectorAll("#welcomeText");
  const randomMessage =
    welcomeMessages[Math.floor(Math.random() * welcomeMessages.length)];
  welcomeElements.forEach((el) => (el.textContent = randomMessage));

  const form = document.getElementById("login_form");
  const togglePassword = document.getElementById("togglePassword");
  const passwordInput = document.getElementById("id_password");
  const submitBtn = form.querySelector('button[type="submit"]');
  const buttonText = submitBtn.querySelector(".button-text");

  form.addEventListener("submit", function (e) {
    if (!form.checkValidity()) {
      e.preventDefault();
      showToast("Please fill in all required fields", 3000, "ERROR");
    } else {
      submitBtn.disabled = true;
      submitBtn.querySelector(".ph-sign-in").classList.remove("ph-sign-in");
      submitBtn.querySelector(".ph-bold").classList.add("ph-circle-notch", "animate-spin");
      buttonText.textContent = "Logging in...";
    }
  });

  togglePassword.addEventListener("click", () => {
    if (passwordInput.type === "password") {
      passwordInput.type = "text";
      togglePassword.classList.remove("ph-eye");
      togglePassword.classList.add("ph-eye-slash");
    } else {
      passwordInput.type = "password";
      togglePassword.classList.remove("ph-eye-slash");
      togglePassword.classList.add("ph-eye");
    }
  });
});
  </script>
  {% if form.errors %}
    <script>
document.addEventListener('DOMContentLoaded', function() {
  {% for err in form.non_field_errors %}showToast("{{ err }}", 3000, 'ERROR');{% endfor %}
});
    </script>
    {% for field in form %}
      {% for error in field.errors %}
        <script>
document.addEventListener("DOMContentLoaded", function () {
  showToast("{{ error }}", 3000, "ERROR");
});
        </script>
      {% endfor %}
    {% endfor %}
  {% endif %}{% endblock content %}